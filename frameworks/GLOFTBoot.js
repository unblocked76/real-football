var gloft=gloft||{};window.ENABLE_IMAEG_POOL=true;gloft.each=function(f,e,d){if(!f){return}if(f instanceof Array){for(var c=0,a=f.length;c<a;c++){if(e.call(d,f[c],c)===false){return}}}else{for(var b in f){if(e.call(d,f[b],b)===false){return}}}};gloft.extend=function(b){var a=arguments.length>=2?Array.prototype.slice.call(arguments,1):[];gloft.each(a,function(d){for(var c in d){if(d.hasOwnProperty(c)){b[c]=d[c]}}});return b};gloft.inherits=function(b,a){function c(){}c.prototype=a.prototype;b.superClass_=a.prototype;b.prototype=new c();b.prototype.constructor=b};gloft.isFunction=function(a){return typeof a==="function"};gloft.isNumber=function(a){return typeof a==="number"||Object.prototype.toString.call(a)==="[object Number]"};gloft.isString=function(a){return typeof a==="string"||Object.prototype.toString.call(a)==="[object String]"};gloft.isArray=function(a){return Array.isArray(a)||(typeof a==="object"&&Object.prototype.toString.call(a)==="[object Array]")};gloft.isUndefined=function(a){return typeof a==="undefined"};gloft.isObject=function(a){return typeof a==="object"&&Object.prototype.toString.call(a)==="[object Object]"};gloft.isCrossOrigin=function(a){if(!a){gloft.log("invalid URL");return false}var d=a.indexOf("://");if(d===-1){return false}var c=a.indexOf("/",d+3);var b=(c===-1)?a:a.substring(0,c);return b!==location.origin};gloft.proxy=function(c,a){var b=Array.prototype.slice.call(arguments,2);return function(){var d=b.concat(Array.prototype.slice.call(arguments,0));return c.apply(a,d)}};gloft.AsyncPool=function(d,a,e,c,f){var b=this;b._finished=false;b._srcObj=d;b._limit=a;b._pool=[];b._iterator=e;b._iteratorTarget=f;b._onEnd=c;b._onEndTarget=f;b._results=d instanceof Array?[]:{};b._errors=d instanceof Array?[]:{};gloft.each(d,function(h,g){b._pool.push({index:g,value:h})});b.size=b._pool.length;b.finishedSize=0;b._workingSize=0;b._limit=b._limit||b.size;b.onIterator=function(g,h){b._iterator=g;b._iteratorTarget=h};b.onEnd=function(h,g){b._onEnd=h;b._onEndTarget=g};b._handleItem=function(){var g=this;if(g._pool.length===0||g._workingSize>=g._limit){return}var i=g._pool.shift();var j=i.value,h=i.index;g._workingSize++;g._iterator.call(g._iteratorTarget,j,h,function(l,k){if(g._finished){return}if(l){g._errors[this.index]=l}else{g._results[this.index]=k}g.finishedSize++;g._workingSize--;if(g.finishedSize===g.size){var m=g._errors.length===0?null:g._errors;g.onEnd(m,g._results);return}g._handleItem()}.bind(i),g)};b.flow=function(){var g=this;if(g._pool.length===0){if(g._onEnd){g._onEnd.call(g._onEndTarget,null,[])}return}for(var h=0;h<g._limit;h++){g._handleItem()}};b.onEnd=function(j,h){b._finished=true;if(b._onEnd){var g=b._onEnd;var i=b._onEndTarget;b._onEnd=null;b._onEndTarget=null;g.call(i,j,h)}}};gloft.async={series:function(d,a,c){var b=new gloft.AsyncPool(d,1,function(g,f,e){g.call(c,e)},a,c);b.flow();return b},parallel:function(d,a,c){var b=new gloft.AsyncPool(d,0,function(g,f,e){g.call(c,e)},a,c);b.flow();return b},waterfall:function(f,a,d){var b=[];var e=[null];var c=new gloft.AsyncPool(f,1,function(i,h,g){b.push(function(j){b=Array.prototype.slice.call(arguments,1);if(f.length-1===h){e=e.concat(b)}g.apply(null,arguments)});i.apply(d,b)},function(g){if(!a){return}if(g){return a.call(d,g)}a.apply(d,e)});c.flow();return c},map:function(f,c,e,d){var a=c;if(typeof(c)==="object"){e=c.cb;d=c.iteratorTarget;a=c.iterator}var b=new gloft.AsyncPool(f,0,a,e,d);b.flow();return b},mapLimit:function(f,b,d,a,e){var c=new gloft.AsyncPool(f,b,d,a,e);c.flow();return c}};gloft.path={normalizeRE:/[^\.\/]+\/\.\.\//,join:function(){var b=arguments.length;var a="";for(var c=0;c<b;c++){a=(a+(a===""?"":"/")+arguments[c]).replace(/(\/|\\\\)$/,"")}return a},extname:function(b){var a=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(b);return a?a[1]:null},mainFileName:function(b){if(b){var a=b.lastIndexOf(".");if(a!==-1){return b.substring(0,a)}}return b},basename:function(e,f){var b=e.indexOf("?");if(b>0){e=e.substring(0,b)}var d=/(\/|\\\\)([^(\/|\\\\)]+)$/g;var a=d.exec(e.replace(/(\/|\\\\)$/,""));if(!a){return null}var c=a[2];if(f&&e.substring(e.length-f.length).toLowerCase()===f.toLowerCase()){return c.substring(0,c.length-f.length)}return c},dirname:function(a){return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(c,d){d=d||"";var b=c.indexOf("?");var a="";if(b>0){a=c.substring(b);c=c.substring(0,b)}b=c.lastIndexOf(".");if(b<0){return c+d+a}return c.substring(0,b)+d+a},changeBasename:function(e,f,b){if(f.indexOf(".")===0){return this.changeExtname(e,f)}var c=e.indexOf("?");var a="";var d=b?this.extname(e):"";if(c>0){a=e.substring(c);e=e.substring(0,c)}c=e.lastIndexOf("/");c=c<=0?0:c+1;return e.substring(0,c)+f+d+a},_normalize:function(a){var b=a=String(a);do{b=a;a=a.replace(this.normalizeRE,"")}while(b.length!==a.length);return a}};gloft.loader=(function(){var b={},d={},a={},c={},e=new RegExp("^(?:https?|ftp)://\\S*$","i");return{resPath:"",cache:{},getXMLHttpRequest:function(){var f=window.XMLHttpRequest?new window.XMLHttpRequest():new ActiveXObject("MSXML2.XMLHTTP");if(f.ontimeout===undefined){f._timeoutId=-1}return f},_getArgs4Js:function(i){var h=i[0],g=i[1],f=i[2],j=["",null,null];if(i.length===1){j[1]=h instanceof Array?h:[h]}else{if(i.length===2){if(typeof g==="function"){j[1]=h instanceof Array?h:[h];j[2]=g}else{j[0]=h||"";j[1]=g instanceof Array?g:[g]}}else{if(i.length===3){j[0]=h||"";j[1]=g instanceof Array?g:[g];j[2]=f}else{throw new Error("arguments error to load js!")}}}return j},isLoading:function(f){return(c[f]!==undefined)},loadJs:function(j,l,f){var g=this,h=g._getArgs4Js(arguments);var i=h[0],k=h[1],m=h[2];if(navigator.userAgent.indexOf("Trident/5")>-1){g._loadJs4Dependency(i,k,0,m)}else{gloft.async.map(k,function(p,o,n){var q=gloft.path.join(i,p);if(b[q]){return n(null)}g._createScript(q,false,n)},m)}},_createScript:function(j,i,f){var k=document,g=this,h=document.createElement("script");h.async=i;b[j]=true;if(gloft.runtime.config.noCache&&typeof j==="string"){if(g._noCacheRex.test(j)){h.src=j+"&_t="+(new Date()-0)}else{h.src=j+"?_t="+(new Date()-0)}}else{h.src=j}h.addEventListener("load",function(){h.parentNode.removeChild(h);this.removeEventListener("load",arguments.callee,false);f()},false);h.addEventListener("error",function(){h.parentNode.removeChild(h);f("Load "+j+" failed!")},false);k.body.appendChild(h)},_loadJs4Dependency:function(i,j,h,f){if(h>=j.length){if(f){f()}return}var g=this;g._createScript(gloft.path.join(i,j[h]),false,function(k){if(k){return f(k)}g._loadJs4Dependency(i,j,h+1,f)})},loadTxt:function(j,f){var l=this.getXMLHttpRequest(),k="load "+j+" failed!";l.open("GET",j,true);if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){l.setRequestHeader("Accept-Charset","utf-8");l.onreadystatechange=function(){if(l.readyState===4){(l.status===200||l.status===0)?f(null,l.responseText):f({status:l.status,errorMessage:k},null)}}}else{if(l.overrideMimeType){l.overrideMimeType("text/plain; charset=utf-8")}var g=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}if(l.readyState===4){(l.status===200||l.status===0)?f(null,l.responseText):f({status:l.status,errorMessage:k},null)}};var i=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}f({status:l.status,errorMessage:k},null)};var h=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}f({status:l.status,errorMessage:"Request timeout: "+k},null)};l.addEventListener("load",g);l.addEventListener("error",i);if(l.ontimeout===undefined){l._timeoutId=setTimeout(function(){h()},l.timeout)}else{l.addEventListener("timeout",h)}}l.send(null)},loadCsb:function(j,f){var l=gloft.loader.getXMLHttpRequest(),k="load "+j+" failed!";l.open("GET",j,true);l.responseType="arraybuffer";var g=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}var m=l.response;if(m){window.msg=m}if(l.readyState===4){(l.status===200||l.status===0)?f(null,l.response):f({status:l.status,errorMessage:k},null)}};var i=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}f({status:l.status,errorMessage:k},null)};var h=function(){l.removeEventListener("load",g);l.removeEventListener("error",i);if(l._timeoutId>=0){clearTimeout(l._timeoutId)}else{l.removeEventListener("timeout",h)}f({status:l.status,errorMessage:"Request timeout: "+k},null)};l.addEventListener("load",g);l.addEventListener("error",i);if(l.ontimeout===undefined){l._timeoutId=setTimeout(function(){h()},l.timeout)}else{l.addEventListener("timeout",h)}l.send(null)},loadJson:function(g,f){this.loadTxt(g,function(j,i){if(j){f(j)}else{try{var h=JSON.parse(i)}catch(k){throw new Error("parse json ["+g+"] failed : "+k);return}f(null,h)}})},_checkIsImageURL:function(f){var g=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(f);return(g!=null)},loadImg:function(f,k,n,h){var g={isCrossOrigin:true};if(n!==undefined){g.isCrossOrigin=k.isCrossOrigin===undefined?g.isCrossOrigin:k.isCrossOrigin}else{if(k!==undefined){n=k}}var m=this.getRes(f);if(m){n&&n(null,m);return null}var l=c[f];if(l){l.callbacks.push(n);return l.img}h=h||(new Image());if(g.isCrossOrigin&&location.origin!=="file://"){h.crossOrigin="Anonymous"}else{h.crossOrigin=null}var i=function(){this.removeEventListener("load",i,false);this.removeEventListener("error",j,false);var q=c[f];if(q){var s=q.callbacks;for(var r=0;r<s.length;++r){var p=s[r];if(p){p(null,h)}}q.img=null;delete c[f]}};var o=this;var j=function(){this.removeEventListener("load",i,false);this.removeEventListener("error",j,false);if(window.location.protocol!=="https:"&&h.crossOrigin&&h.crossOrigin.toLowerCase()==="anonymous"){g.isCrossOrigin=false;o.release(f);gloft.loader.loadImg(f,g,n,h)}else{var q=c[f];if(q){var s=q.callbacks;for(var r=0;r<s.length;++r){var p=s[r];if(p){p("load image failed")}}q.img=null;delete c[f]}}};c[f]={img:h,callbacks:n?[n]:[]};h.addEventListener("load",i);h.addEventListener("error",j);h.src=f;return h},_loadResIterator:function(n,j,g){var o=this,f=null;var k=n.type;if(k){k="."+k.toLowerCase();f=n.src?n.src:n.name+k}else{f=n;k=gloft.path.extname(f)}var i=o.getRes(f);if(i){return g(null,i)}var l=null;if(k){l=d[k.toLowerCase()]}if(!l){l=gloft._binaryLoader}var h=f;if(!e.test(f)){var m=l.getBasePath?l.getBasePath():o.resPath;h=o.getUrl(m,f)}if(gloft.runtime.config.noCache&&typeof h==="string"){if(o._noCacheRex.test(h)){h+="&_t="+(new Date()-0)}else{h+="?_t="+(new Date()-0)}}l.load(h,f,n,function(p,q){if(p){gloft.log(p);o.cache[f]=null;delete o.cache[f];g({status:520,errorMessage:p},null)}else{o.cache[f]=q;g(null,q)}})},_noCacheRex:/\?/,getUrl:function(l,h){var g=this,j=gloft.path;if(l!==undefined&&h===undefined){h=l;var i=j.extname(h);i=i?i.toLowerCase():"";var f=d[i];if(!f){l=g.resPath}else{l=f.getBasePath?f.getBasePath():g.resPath}}h=gloft.path.join(l||"",h);if(h.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(a[h]){return a[h]}var k=j.extname(h)||"";h=a[h]=h.substring(0,h.length-k.length)+"_"+gloft.sys.language+k}return h},load:function(k,j,g){var h=this;var f=arguments.length;if(f===0){throw new Error("arguments error!")}if(f===3){if(typeof j==="function"){if(typeof g==="function"){j={trigger:j,cb:g}}else{j={cb:j,cbTarget:g}}}}else{if(f===2){if(typeof j==="function"){j={cb:j}}}else{if(f===1){j={}}}}if(!(k instanceof Array)){k=[k]}var i=new gloft.AsyncPool(k,gloft.CONCURRENCY_HTTP_REQUEST_COUNT,function(o,m,n,l){h._loadResIterator(o,m,function(q){var p=Array.prototype.slice.call(arguments,1);if(j.trigger){j.trigger.call(j.triggerTarget,p[0],l.size,l.finishedSize)}n(q,p[0])})},j.cb,j.cbTarget);i.flow();return i},register:function(k,g){if(!k||!g){return}var h=this;if(typeof k==="string"){return d[k.trim().toLowerCase()]=g}for(var j=0,f=k.length;j<f;j++){d["."+k[j].trim().toLowerCase()]=g}},getRes:function(f){return this.cache[f]||this.cache[gloft.path.basename(f)]},release:function(h){var g=this.cache;var f=c[h];if(f){f.img=null;delete c[h]}delete g[h]},releaseAll:function(){var g=this.cache;for(var f in g){delete g[f]}}}})();gloft.formatStr=function(){var e=arguments;var c=e.length;if(c<1){return""}var g=e[0];var d=true;if(typeof g==="object"){d=false}for(var f=1;f<c;++f){var b=e[f];if(d){while(true){var a=null;if(typeof b==="number"){a=g.match(/(%d)|(%s)/);if(a){g=g.replace(/(%d)|(%s)/,b);break}}a=g.match(/%s/);if(a){g=g.replace(/%s/,b)}else{g+="    "+b}break}}else{g+="    "+b}}return g};(function(){var h=document.createElement("canvas"),g=document.createElement("canvas");gloft.create3DContext=function(m,o){var r=["webgl","experimental-webgl","webkit-3d","moz-webgl"];var n=null;for(var p=0;p<r.length;++p){try{n=m.getContext(r[p],o)}catch(q){}if(n){break}}return n};var c=function(){gloft.sys={};var y=gloft.sys;y.LANGUAGE_ENGLISH="en";y.LANGUAGE_CHINESE="zh";y.LANGUAGE_FRENCH="fr";y.LANGUAGE_ITALIAN="it";y.LANGUAGE_GERMAN="de";y.LANGUAGE_SPANISH="es";y.LANGUAGE_DUTCH="du";y.LANGUAGE_RUSSIAN="ru";y.LANGUAGE_KOREAN="ko";y.LANGUAGE_JAPANESE="ja";y.LANGUAGE_HUNGARIAN="hu";y.LANGUAGE_PORTUGUESE="pt";y.LANGUAGE_ARABIC="ar";y.LANGUAGE_NORWEGIAN="no";y.LANGUAGE_POLISH="pl";y.LANGUAGE_UNKNOWN="unkonwn";y.OS_IOS="iOS";y.OS_ANDROID="Android";y.OS_WINDOWS="Windows";y.OS_MARMALADE="Marmalade";y.OS_LINUX="Linux";y.OS_BADA="Bada";y.OS_BLACKBERRY="Blackberry";y.OS_OSX="OS X";y.OS_WP8="WP8";y.OS_WINRT="WINRT";y.OS_UNKNOWN="Unknown";y.UNKNOWN=-1;y.WIN32=0;y.LINUX=1;y.MACOS=2;y.ANDROID=3;y.IPHONE=4;y.IPAD=5;y.BLACKBERRY=6;y.NACL=7;y.EMSCRIPTEN=8;y.TIZEN=9;y.WINRT=10;y.WP8=11;y.MOBILE_BROWSER=100;y.DESKTOP_BROWSER=101;y.BROWSER_TYPE_WECHAT="wechat";y.BROWSER_TYPE_ANDROID="androidbrowser";y.BROWSER_TYPE_IE="ie";y.BROWSER_TYPE_QQ_APP="qq";y.BROWSER_TYPE_QQ="qqbrowser";y.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";y.BROWSER_TYPE_UC="ucbrowser";y.BROWSER_TYPE_360="360browser";y.BROWSER_TYPE_BAIDU_APP="baiduboxapp";y.BROWSER_TYPE_BAIDU="baidubrowser";y.BROWSER_TYPE_MAXTHON="maxthon";y.BROWSER_TYPE_OPERA="opera";y.BROWSER_TYPE_OUPENG="oupeng";y.BROWSER_TYPE_MIUI="miuibrowser";y.BROWSER_TYPE_FIREFOX="firefox";y.BROWSER_TYPE_SAFARI="safari";y.BROWSER_TYPE_CHROME="chrome";y.BROWSER_TYPE_LIEBAO="liebao";y.BROWSER_TYPE_QZONE="qzone";y.BROWSER_TYPE_SOUGOU="sogou";y.BROWSER_TYPE_UNKNOWN="unknown";var u=window,z=u.navigator,M=document,v=M.documentElement;var E=z.userAgent.toLowerCase();y.isMobile=/mobile|android|iphone|ipad/.test(E);y.platform=y.isMobile?y.MOBILE_BROWSER:y.DESKTOP_BROWSER;var q=z.language;q=q?q:z.browserLanguage;q=q?q.split("-")[0]:y.LANGUAGE_ENGLISH;y.language=q;var L=false,t=false,o="",A=0;var D=/android (\d+(?:\.\d+)+)/i.exec(E)||/android (\d+(?:\.\d+)+)/i.exec(z.platform);if(D){L=true;o=D[1]||"";A=parseInt(o)||0}D=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(E);if(D){t=true;o=D[2]||"";A=parseInt(o)||0}else{if(/(iPhone|iPad|iPod)/.exec(z.platform)){t=true;o="";A=0}}var G=y.OS_UNKNOWN;if(z.appVersion.indexOf("Win")!==-1){G=y.OS_WINDOWS}else{if(t){G=y.OS_IOS}else{if(z.appVersion.indexOf("Mac")!==-1){G=y.OS_OSX}else{if(z.appVersion.indexOf("X11")!==-1&&z.appVersion.indexOf("Linux")===-1){G=y.OS_UNIX}else{if(L){G=y.OS_ANDROID}else{if(z.appVersion.indexOf("Linux")!==-1){G=y.OS_LINUX}}}}}}y.os=G;y.osVersion=o;y.osMainVersion=A;y.browserType=y.BROWSER_TYPE_UNKNOWN;(function(){var O=/micromessenger|mqqbrowser|sogou|qzone|liebao|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i;var N=/qqbrowser|qq|chrome|safari|firefox|opr|oupeng|opera/i;var P=O.exec(E);if(!P){P=N.exec(E)}var w=P?P[0]:y.BROWSER_TYPE_UNKNOWN;if(w==="micromessenger"){w=y.BROWSER_TYPE_WECHAT}else{if(w==="safari"&&L){w=y.BROWSER_TYPE_ANDROID}else{if(w==="trident"){w=y.BROWSER_TYPE_IE}else{if(w==="360 aphone"){w=y.BROWSER_TYPE_360}else{if(w==="mxbrowser"){w=y.BROWSER_TYPE_MAXTHON}else{if(w==="opr"){w=y.BROWSER_TYPE_OPERA}}}}}}y.browserType=w})();y.browserVersion="";(function(){var O=/(mqqbrowser|micromessenger|sogou|qzone|liebao|maxthon|mxbrowser|baidu)(mobile)?(browser)?\/?([\d.]+)/i;var w=/(msie |rv:|firefox|chrome|ucbrowser|qq|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i;var N=E.match(O);if(!N){N=E.match(w)}y.browserVersion=N?N[4]:""})();var C=window.innerWidth||document.documentElement.clientWidth;var F=window.innerHeight||document.documentElement.clientHeight;var x=window.devicePixelRatio||1;y.windowPixelResolution={width:x*C,height:x*F};y._checkWebGLRenderMode=function(){if(gloft._renderType!==gloft.runtime.RENDER_TYPE_WEBGL){throw new Error("This feature supports WebGL render mode only.")}};y._supportCanvasNewBlendModes=(function(){var w=h;w.width=1;w.height=1;var N=w.getContext("2d");N.fillStyle="#000";N.fillRect(0,0,1,1);N.globalCompositeOperation="multiply";var O=g;O.width=1;O.height=1;var P=O.getContext("2d");P.fillStyle="#fff";P.fillRect(0,0,1,1);N.drawImage(O,0,0,1,1);return N.getImageData(0,0,1,1).data[0]===0})();if(gloft.sys.isMobile){var r=document.createElement("style");r.type="text/css";document.body.appendChild(r);r.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var J=y.localStorage=u.localStorage;J.setItem("storage","");J.removeItem("storage");J=null}catch(I){var H=function(){gloft.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")};y.localStorage={getItem:function(O){var N=O+"=";var Q=decodeURIComponent(document.cookie);var w=Q.split(";");for(var P=0;P<w.length;P++){var R=w[P];while(R.charAt(0)==" "){R=R.substring(1)}if(R.indexOf(N)==0){return R.substring(N.length,R.length)}}return null},setItem:function(N,Q,O){if(O==undefined){O=365}var P=new Date();P.setTime(P.getTime()+(O*24*60*60*1000));var w="expires="+P.toUTCString();document.cookie=N+"="+Q+";"+w+";path=/"},removeItem:H,clear:H}}var K=!!h.getContext("2d");var B=false;if(u.WebGLRenderingContext){var m=document.createElement("CANVAS");try{var n=gloft.create3DContext(m);if(n){B=true}if(B&&y.os===y.OS_IOS&&y.osMainVersion===9){if(!window.indexedDB){B=false}}if(B&&y.os===y.OS_ANDROID){var p=parseFloat(y.browserVersion);switch(y.browserType){case y.BROWSER_TYPE_MOBILE_QQ:case y.BROWSER_TYPE_BAIDU:case y.BROWSER_TYPE_BAIDU_APP:if(p>=6.2){B=true}else{B=false}break;case y.BROWSER_TYPE_CHROME:if(p>=30){B=true}else{B=false}break;case y.BROWSER_TYPE_ANDROID:if(y.osMainVersion&&y.osMainVersion>=5){B=true}break;case y.BROWSER_TYPE_UNKNOWN:case y.BROWSER_TYPE_360:case y.BROWSER_TYPE_MIUI:case y.BROWSER_TYPE_UC:B=false}}}catch(I){}m=null}var s=y.capabilities={canvas:K,opengl:B};if(v.ontouchstart!==undefined||M.ontouchstart!==undefined||z.msPointerEnabled){s.touches=true}if(v.onmouseup!==undefined){s.mouse=true}if(v.onkeyup!==undefined){s.keyboard=true}if(u.DeviceMotionEvent||u.DeviceOrientationEvent){s.accelerometer=true}y.isObjectValid=function(w){if(w){return true}else{return false}};y.dump=function(){var w=this;var N="";N+="isMobile : "+w.isMobile+"\r\n";N+="language : "+w.language+"\r\n";N+="browserType : "+w.browserType+"\r\n";N+="browserVersion : "+w.browserVersion+"\r\n";N+="capabilities : "+JSON.stringify(w.capabilities)+"\r\n";N+="os : "+w.os+"\r\n";N+="osVersion : "+w.osVersion+"\r\n";N+="platform : "+w.platform+"\r\n";N+="Using "+(gloft._renderType===gloft.runtime.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n";gloft.log(N)};y.now=function(){if(Date.now){return Date.now()}else{return +(new Date)}}};c();h=null;g=null;gloft.log=gloft.warn=gloft.error=gloft.assert=function(){};var j=null,a={},l=false,d=null;gloft._engineLoaded=false;function i(){var n=gloft.runtime.config,o=gloft.runtime.CONFIG_KEY,m=parseInt(n[o.renderMode])||0;if(isNaN(m)||m>2||m<0){n[o.renderMode]=0}gloft._renderType=gloft.runtime.RENDER_TYPE_CANVAS;gloft._supportRender=false;if(m===0){if(gloft.sys.capabilities.opengl){gloft._renderType=gloft.runtime.RENDER_TYPE_WEBGL;gloft._supportRender=true}else{if(gloft.sys.capabilities.canvas){gloft._renderType=gloft.runtime.RENDER_TYPE_CANVAS;gloft._supportRender=true}}}else{if(m===1&&gloft.sys.capabilities.canvas){gloft._renderType=gloft.runtime.RENDER_TYPE_CANVAS;gloft._supportRender=true}else{if(m===2&&gloft.sys.capabilities.opengl){gloft._renderType=gloft.runtime.RENDER_TYPE_WEBGL;gloft._supportRender=true}}}}function k(t,m,n){if(a[m]){return null}n=n||"";var q=[];var s=t[m];if(!s){throw new Error("can not find module ["+m+"]")}var w=gloft.path;for(var o=0,u=s.length;o<u;o++){var v=s[o];if(a[v]){continue}var r=w.extname(v);if(!r){var p=k(t,v,n);if(p){q=q.concat(p)}}else{if(r.toLowerCase()===".js"){q.push(w.join(n,v))}}a[v]=1}return q}function b(){if(gloft._initDebugSetting){gloft._initDebugSetting(gloft.runtime.config[gloft.runtime.CONFIG_KEY.debugMode])}gloft._engineLoaded=true;gloft.sys.dump();console.log(gloft.ENGINE_VERSION);if(d){d()}}function f(){var o=this;var p=gloft.runtime.config,r=gloft.runtime.CONFIG_KEY,q=p[r.engineDir],m=gloft.loader;if(gloft.Class){b()}else{var n=gloft.path.join(q,"modules.json");m.loadJson(n,function(y,x){if(y){throw new Error(y)}var u=p.modules||[];var w=x.module;var z=[];for(var v=0,t=u.length;v<t;v++){var s=k(w,u[v],q);if(s){z=z.concat(s)}}gloft.loader.loadJs(z,function(A){if(A){throw A}b()})})}}function e(){this.removeEventListener("load",e,false);f()}gloft.initEngine=function(m){if(l){var n=d;d=function(){n&&n();m&&m()};return}d=m;i();document.body?f():gloft._addEventListener(window,"load",e,false);l=true}})();gloft.runtime={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",exposeClassName:"exposeClassName",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",midletName:"MidletName",jsList:"jsList"},_paused:true,_prepareCalled:false,_prepared:false,_rendererInitialized:false,_intervalId:null,frame:null,container:null,canvas:null,renderContext:null,config:null,pause:function(){gloft.log("runtime# pause");if(this._paused){return}this._paused=true;if(this._intervalWaitingNextFrameId){window.cancelAnimationFrame(this._intervalWaitingNextFrameId)}this._intervalWaitingNextFrameId=0;if(this._intervalId){window.cancelAnimationFrame(this._intervalId)}this._intervalId=0},resume:function(){gloft.log("runtime# resume");if(!this._paused){return}this._paused=false;this._runMainLoop()},isPaused:function(){return this._paused},_start:function(){var a=this,b=a.config,c=a.CONFIG_KEY;var d=new window[b[c.midletName]]();d.startApp()},prepare:function(a){var b=this,c=b.config,f=b.CONFIG_KEY;if(this._prepared){if(a){a()}return}if(this._prepareCalled){return}if(gloft._engineLoaded){gloft.log("runtime# preparing...");this._prepareCalled=true;this._initRenderer(c[f.width],c[f.height]);gloft.director=gloft.Director._getInstance();gloft.director.setDisplayStats(c[f.showFPS]);this._initEvents();this._setAnimFrame();this._runMainLoop();var e=c[f.jsList];var d=c.baseDir;if(e){gloft.loader.loadJs(d,e,function(g){if(g){throw new Error(g)}gloft.loader.resPath=d;gloft.loader.load(c.rsList,function(h){if(h){throw new Error(h)}b._prepared=true;if(a){a()}})})}else{if(a){a()}}return}gloft.initEngine(function(){b.prepare(a)})},run:function(a){this._initConfig(a);this.prepare(gloft.runtime._start&&gloft.runtime._start.bind(gloft.runtime))},_setAnimFrame:function(){if(gloft.runtime.config[gloft.runtime.CONFIG_KEY.debugMode]>0){window.requestAnimFrame=this._stTime;window.cancelAnimationFrame=this._ctTime}else{window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime;window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime}},_stTime:function(b){var a=window.setTimeout(function(){b()},0);return a},_ctTime:function(a){window.clearTimeout(a)},_runMainLoop:function(f){gloft.log("runtime# runMainLoop");var b=this,h,d=b.config,g=b.CONFIG_KEY,a=gloft.director;var c=gloft.runtime.config[gloft.runtime.CONFIG_KEY.frameRate];var e=1000/c;var f=f;h=function(){if(!b._paused||f===true){try{if(b._intervalWaitingNextFrameId){window.cancelAnimationFrame(b._intervalWaitingNextFrameId)}b._intervalWaitingNextFrameId=0;a.mainLoop();if(f===true){return}var j=e-a._millisecondsPerFrame;if(j>0){b._intervalWaitingNextFrameId=window.setTimeout(function(){if(b._intervalWaitingNextFrameId){b._intervalId=window.requestAnimFrame(h)}},j)}else{b._intervalId=window.requestAnimFrame(h)}}catch(i){gloft.error(i)}}};if(f===true){h()}else{b._intervalId=window.requestAnimFrame(h);b._paused=false}},_initConfig:function(b){var c=this.CONFIG_KEY,a=b[c.modules];if(b[c.midletName]==null){throw new Error("Missing MidletName")}b[c.showFPS]=typeof b[c.showFPS]==="undefined"?true:b[c.showFPS];b[c.engineDir]=b[c.engineDir]||"frameworks";if(b[c.debugMode]==null){b[c.debugMode]=0}b[c.exposeClassName]=!!b[c.exposeClassName];b[c.frameRate]=b[c.frameRate]||60;if(b[c.renderMode]==null){b[c.renderMode]=0}if(gloft.sys.capabilities.opengl&&a.indexOf("webgl-2d")<0){a.splice(0,0,"webgl-2d")}if(a&&a.indexOf("core")<0){a.splice(0,0,"core")}a&&(b[c.modules]=a);this.config=b},_initRenderer:function(c,k){if(this._rendererInitialized){return}if(!gloft._supportRender){throw new Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode])}var d=this.config[gloft.runtime.CONFIG_KEY.id],f=window,e=gloft.$(d)||gloft.$("#"+d),h,b,g;if(e.tagName==="CANVAS"){c=c||e.width;k=k||e.height;this.canvas=h=e;this.container=b=document.createElement("DIV");if(h.parentNode){h.parentNode.insertBefore(b,h)}}else{if(e.tagName!=="DIV"){gloft.log("Warning: target element is not a DIV or CANVAS")}c=c||e.clientWidth;k=k||e.clientHeight;this.canvas=h=gloft.$(document.createElement("CANVAS"));this.container=b=document.createElement("DIV");e.appendChild(b)}b.setAttribute("id","gameContainer");b.appendChild(h);this.frame=(b.parentNode===document.body)?document.documentElement:b.parentNode;h.addClass("gameCanvas");h.setAttribute("width",c||240);h.setAttribute("height",k||320);h.setAttribute("tabindex",99);h.enableBatchRender=this.config.usingRenderBatch===true;if(gloft._renderType===gloft.runtime.RENDER_TYPE_WEBGL){WebGL2D.enable(h);this.renderContext=h.getContext("webgl-2d")}if(!this.renderContext){gloft._renderType=gloft.runtime.RENDER_TYPE_CANVAS;this.renderContext=h.getContext("2d")}gloft.runtime.canvas.oncontextmenu=function(){if(!gloft._isContextMenuEnable){return false}};window.addEventListener("keydown",function(m){if(m.keyCode===19){if(gloft.runtime.isPaused()){gloft.runtime._runMainLoop(true)}else{gloft.runtime.pause()}m.stopPropagation();m.preventDefault()}else{if(m.ctrlKey===true&&m.keyCode===80){gloft.runtime.resume();m.stopPropagation();m.preventDefault()}else{if(gloft.runtime.canvas.keyPressedListener){var o=gloft.runtime.config.mapKeyCode;var n=o[m.keyCode];if(n!=undefined){gloft.runtime.canvas.keyPressedListener(n);m.stopPropagation();m.preventDefault()}}}}},false);window.addEventListener("keyup",function(m){if(gloft.runtime.canvas.keyReleasedListener){var o=gloft.runtime.config.mapKeyCode;var n=o[m.keyCode];if(n!=undefined){gloft.runtime.canvas.keyReleasedListener(n);m.stopPropagation();m.preventDefault()}}},false);if(gloft.runtime.config.autoFitScreen!==false){var i=this.container.getBoundingClientRect();var a=i.width/this.canvas.width;var l=i.height/this.canvas.height;var j=Math.min(a,l);this.canvas.style.width=((j*this.canvas.width)|0)+"px";this.canvas.style.height=((j*this.canvas.height)|0)+"px"}this._rendererInitialized=true},_initEvents:function(){var d=window,c;if(!gloft.isUndefined(document.hidden)){c="hidden"}else{if(!gloft.isUndefined(document.mozHidden)){c="mozHidden"}else{if(!gloft.isUndefined(document.msHidden)){c="msHidden"}else{if(!gloft.isUndefined(document.webkitHidden)){c="webkitHidden"}}}}var a=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"];var f=function(){if(gloft.runtime.bHidden===true){return}gloft.runtime.bHidden=true;if(gloft.runtime.onHidden){gloft.runtime.onHidden()}gloft.runtime.pause()};var e=function(){if(gloft.runtime.bHidden===false){return}gloft.runtime.bHidden=false;if(gloft.runtime.onShow){gloft.runtime.onShow()}gloft.runtime.resume()};if(c){for(var b=0;b<a.length;b++){document.addEventListener(a[b],function(g){var h=document[c];h=h||g.hidden;if(h){f()}else{e()}},false)}}else{d.addEventListener("blur",f,false);d.addEventListener("focus",e,false)}if(navigator.userAgent.indexOf("MicroMessenger")>-1){d.onfocus=function(){e()}}if("onpageshow" in window&&"onpagehide" in window){d.addEventListener("pagehide",f,false);d.addEventListener("pageshow",e,false)}}};Function.prototype.bind=Function.prototype.bind||function(a){if(!gloft.isFunction(this)){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c};gloft.handleLoadedTexture=function(a){if(gloft._renderType===gloft.runtime.RENDER_TYPE_WEBGL){gloft.runtime.renderContext.handleLoadedTexture(a)}};gloft.casttobyte=function(b){if(b==null){return 0}var a=(b<<24>>24);return a};gloft.casttoshort=function(a){if(a==null){return 0}var b=(a<<16>>16);return b};gloft.casttoint=function(b){if(b==null){return 0}if(typeof b=="string"&&b.length==1){return b.charCodeAt(0)}var a;a=(b|0);return a};gloft.casttolong=function(a){if(a==null){return 0}return a>>>0};gloft.casttochar=function(a){if(a==null){return""}return String.fromCharCode(a)};gloft.casttoboolean=function(a){if(a==null){return false}return a};gloft.ArrayCreation=function(c,d){if(c==null||c.length<=0||c[0]==undefined||c[0]==null){throw new Error("Invalid Dimensions")}if(d instanceof Array&&d.length==0){d=null}var e=new Array(c[0]);var b=c[0];if(c.length>1){var a=Array.prototype.slice.call(c,1);while(b--){e[c[0]-1-b]=gloft.ArrayCreation(a,d)}}else{if(typeof d!=="undefined"){while(b--){e[c[0]-1-b]=d}}}return e};gloft.arrayBufferToBase64=function(c,f,e){if(f==undefined){f=0}if(e==undefined){e=c.length}var g="";var b=new Uint8Array(c,f,e);var a=b.byteLength;for(var d=0;d<a;d++){g+=String.fromCharCode(b[d])}return window.btoa(g)};gloft.base64ToArrayBuffer=function(d){var c=window.atob(d);var a=c.length;var b=new Int8Array(a);for(var e=0;e<a;e++){b[e]=c.charCodeAt(e)}return b};Error.prototype.printStackTrace=function(){gloft.error(this)};window.getResourceAsStream=function(a){var b=gloft.loader.getRes(a);if(b==null){gloft.warn("[NULL][getResourceAsStream] : <"+a+">")}return b!=null?new ByteArrayInputStream(b):null};