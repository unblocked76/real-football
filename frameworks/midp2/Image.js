"use strict";var _p=window;var javax=_p.javax=_p.javax||{};var microedition=_p.javax.microedition=_p.javax.microedition||{};var lcdui=_p.javax.microedition.lcdui=_p.javax.microedition.lcdui||{};var Midp2Image=_p.javax.microedition.lcdui.Image=gloft.Class.extend({m_HTMLCanvasElement:null,ctor:function(){if(arguments[0] instanceof HTMLCanvasElement){this.m_HTMLCanvasElement=arguments[0]}else{this.m_HTMLCanvasElement=document.createElement("canvas");var a=this.m_HTMLCanvasElement.getContext("2d");a.globalAlpha=1;a.lineWidth=1;if(arguments[0] instanceof Image){var b=arguments[0];this.m_HTMLCanvasElement.width=b.width;this.m_HTMLCanvasElement.height=b.height;a.drawImage(b,0,0)}else{this.m_HTMLCanvasElement.width=arguments[0];this.m_HTMLCanvasElement.height=arguments[1]}}if(this.m_HTMLCanvasElement.width<=0||this.m_HTMLCanvasElement.height<=0){throw new Error("Invalid")}gloft.handleLoadedTexture(this.m_HTMLCanvasElement)},getWidth:function(){return this.m_HTMLCanvasElement.width},getHeight:function(){return this.m_HTMLCanvasElement.height},_setRGB:function(l,f,e,m,k,q,o,s){var d=this.m_HTMLCanvasElement;this._hasAlpha=d._hasAlpha=s;var r=d.getContext("2d");var p=r.getImageData(0,0,d.width,d.height);var h=new Uint32Array(p.data.buffer);var i=0;for(var t=k;t<k+o;t++){for(var u=m;u<m+q;u++){var n=l[f+(u-m)+(t-k)*e];var i=t*(q)+u;var j=(n>>16)&255;var c=(n>>0)&255;var g=(n&4278255360)|(c<<16)|j;h[i]=g}}r.putImageData(p,0,0);gloft.handleLoadedTexture(this.m_HTMLCanvasElement)},getRGB:function(k,g,e,l,j,q,o){var d=this.m_HTMLCanvasElement;var r=d.getContext("2d");var s=r.getImageData(l,j,q,o);var p=s.data;var h=0;for(var t=j;t<j+o;t++){for(var u=l;u<l+q;u++){var i=p[h++]&255;var m=p[h++]&255;var c=p[h++]&255;var f=p[h++]&255;var n=(f<<24)|(i<<16)|(m<<8)|(c);k[g+(u-l)+(t-j)*e]=n}}},getHTMLCanvasElement:function(){return this.m_HTMLCanvasElement},getGraphics:function(){if(this.m_Graphics==null){this.m_Graphics=new Graphics(this.m_HTMLCanvasElement)}return this.m_Graphics},});Midp2Image.createImage=function(){if(arguments){switch(arguments.length){case 1:if(arguments[0] instanceof Midp2Image){return Midp2Image._createImage_1_1.apply(this,arguments)}else{if(arguments[0] instanceof InputStream){return Midp2Image._createImage_1_2.apply(this,arguments)}else{return Midp2Image._createImage_1_3.apply(this,arguments)}}case 2:return Midp2Image._createImage_2.apply(this,arguments);case 3:return Midp2Image._createImage_3.apply(this,arguments);case 6:return Midp2Image._createImage_6.apply(this,arguments)}}throw new Error("InvalidArguments")};Midp2Image._createImage_3=function(a,d,c){var e=new Uint8Array(a,d,c);var b=gloft.decodeImageData(e);if(!!b){return new Midp2Image(b)}else{throw new Error("invalid.")}};Midp2Image._createImage_1_1=function(a){throw new Error("Not implemented yet!")};Midp2Image._createImage_6=function(d,h,g,b,i,c){var f=d.m_HTMLCanvasElement;var j=f.getContext("2d");var a=j.getImageData(h,g,b,i);var e=new Midp2Image(b,i);e.m_HTMLCanvasElement.getContext("2d").putImageData(a,0,0);gloft.handleLoadedTexture(e.m_HTMLCanvasElement);return e};Midp2Image._createImage_2=function(b,a){var c=new Midp2Image(b,a);return c};Midp2Image._createImage_1_3=function(b){var a=gloft.loader.getRes(b);return new Midp2Image(a)};Midp2Image.createRGBImage=function(e,b,a,c){var d=Midp2Image.createImage(b,a);d._setRGB(e,0,b,0,0,b,a,c);return d};