gloft.g_NumberOfDraws=0;gloft.Director=gloft.Class.extend({_deltaTime:0,_lastUpdate:null,_secondsPerFrame:0,_millisecondsPerFrame:0,_schedulerOnce:[],ctor:function(){var a=this;this._schedulerOnce=[]},init:function(){this._lastUpdate=Date.now();return true},calculateDeltaTime:function(){var a=Date.now();this._deltaTime=(a-this._lastUpdate)/1000;this._lastUpdate=a},doFrame:function(){this.calculateDeltaTime();var c=this._schedulerOnce;this._schedulerOnce=[];for(var b=c.length-1;b>=0;b--){try{if(typeof c[b]=="function"){c[b]();delete c[b]}}catch(a){if(a.stack){gloft.error("_scheduler["+b+"]\n"+a.stack)}else{gloft.error("_scheduler["+b+"]\n"+a)}throw a}}c.length=0;if(gloft.runtime.canvas.graphics){if(gloft.runtime.canvas.enableBatchRender){gloft.runtime.canvas.graphics.rendering()}gloft.g_NumberOfDraws=gloft.runtime.canvas.graphics._drawCount;gloft.runtime.canvas.graphics._drawCount=0}if(gloft.profiler){gloft.profiler.update()}gloft.g_NumberOfDraws=0;this._calculateMPF()},setDisplayStats:function(a){if(gloft.profiler){a?gloft.profiler.showStats():gloft.profiler.hideStats()}},getSecondsPerFrame:function(){return this._secondsPerFrame},getDeltaTime:function(){return this._deltaTime},_calculateMPF:function(){var a=Date.now();this._millisecondsPerFrame=(a-this._lastUpdate);this._secondsPerFrame=this._millisecondsPerFrame/1000},addSchedulerOnce:function(d,b){var c=Array.prototype.slice.call(arguments,2);var a=function(){var e=c.concat(Array.prototype.slice.call(arguments,0));return d.apply(b,e)};this._schedulerOnce.push(a);return Date.now()},});gloft.DisplayLinkDirector=gloft.Director.extend({mainLoop:function(){this.doFrame()},});gloft.Director.sharedDirector=null;gloft.Director.firstUseDirector=true;gloft.Director._getInstance=function(){if(gloft.Director.firstUseDirector){gloft.Director.firstUseDirector=false;gloft.Director.sharedDirector=new gloft.DisplayLinkDirector();gloft.Director.sharedDirector.init()}return gloft.Director.sharedDirector};